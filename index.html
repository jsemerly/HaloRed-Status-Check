<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Where is My HaloRed?</title>

  <style>
    :root{
      --bg-dark: #111;
      --panel: #8fbfbe;
      --text: #0d0f10;
      --muted: rgba(0,0,0,.65);
      --btn: #111;
      --btnText: #fff;
      --radius: 16px;
    }

    *{ box-sizing: border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#0b0b0b;
      color: var(--text);
    }

    .wrap{
      min-height: 100vh;
      display: grid;
      grid-template-columns: 1.15fr 0.85fr;
    }

    /* LEFT */
    .left{
      background: var(--bg-dark);
      padding: 36px 32px;
      display: flex;
      flex-direction: column;
      gap: 28px;
    }

    /* Bigger logo */
    .brand{
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .brand img{
      height: 64px;
      width: auto;
      display:block;
    }

    .hero{
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero img{
      width: min(540px, 95%);
      border-radius: 10px;
      box-shadow: 0 18px 60px rgba(0,0,0,.55);
    }

    /* RIGHT */
    .right{
      background: var(--panel);
      padding: 40px 36px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .panel{
      width: min(520px, 100%);
    }

    h1{
      margin: 0 0 24px 0;
      font-size: clamp(26px, 3vw, 34px);
      letter-spacing: -0.02em;
    }

    label{
      display:block;
      font-weight: 800;
      margin-bottom: 8px;
    }

    input{
      width: 100%;
      border: 0;
      outline: none;
      background: rgba(255,255,255,.8);
      padding: 14px 16px;
      border-radius: 10px;
      font-size: 18px;
    }

    .btn{
      margin-top: 18px;
      width: 100%;
      border: 0;
      cursor: pointer;
      background: var(--btn);
      color: var(--btnText);
      padding: 15px;
      border-radius: 999px;
      font-size: 16px;
      font-weight: 800;
      transition: transform .08s ease, opacity .2s ease;
    }

    .btn:active{ transform: scale(0.98); }
    .btn[disabled]{ opacity: .6; cursor:not-allowed; }

    .result{
      margin-top: 22px;
      background: rgba(255,255,255,.85);
      border-radius: var(--radius);
      padding: 16px;
      display:none;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
    }
    .result.show{ display:block; }

    .result-header{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .pill{
      font-size: 12px;
      font-weight: 800;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.15);
      white-space: nowrap;
    }

    .muted{
      color: var(--muted);
      font-size: 14px;
      margin-top: 8px;
    }

    .error{
      margin-top: 14px;
      font-weight: 700;
      color: #7a0b0b;
      display:none;
    }
    .error.show{ display:block; }

    /* MOBILE */
    @media (max-width: 900px){
      .wrap{
        grid-template-columns: 1fr;
      }
      .brand img{
        height: 52px;
      }
    }
  </style>
</head>

<body>
<div class="wrap">

  <!-- LEFT -->
  <section class="left">
    <div class="brand">
      <!-- Replace with your logo file -->
      <img src="halotherapy-logo.png" alt="Halotherapy Solutions">
    </div>

    <div class="hero">
      <!-- Replace with your HaloRed image -->
      <img src="halored-hero.png" alt="HaloRed Unit">
    </div>
  </section>

  <!-- RIGHT -->
  <section class="right">
    <div class="panel">
      <h1>Where is My HaloRed?</h1>

      <label for="soInput">Sales Order Number</label>
      <input id="soInput" placeholder="SO12345" />

      <button id="checkBtn" class="btn">Check Status</button>

      <div id="errorBox" class="error"></div>

      <div id="resultBox" class="result">
        <div class="result-header">
          <div>
            <strong id="resultTitle">Status Found</strong>
            <div class="muted" id="resultMeta"></div>
          </div>
          <div class="pill" id="statusPill"></div>
        </div>

        <div id="resultMessage" style="white-space: pre-line;"></div>
        <div class="muted">If you believe this is incorrect, please contact our team.</div>
      </div>
    </div>
  </section>

</div>

<script>
  // ✅ Paste your Apps Script Web App URL here (must end with /exec)
  const SCRIPT_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbzC6_N0cMB066lWHd7SxPWdy0YNeBPdmTt56F71ONMlnsMnzr1imnQDlHvymQMmFqyt/exec";

  // Messages per status (keeps your same format; replaces the text)
  // (INPUT) is automatically filled with:
  // - ETA status: data.eta (Sheet column I)
  // - Delivered status: data.deliveredDate (Sheet column L)
  const STATUS_MESSAGES = {
    "Awaiting Production": () =>
      `Your HaloRed is awaiting production. This means we are waiting for our production team to begin building your unit -- Before production can happen, we need you to complete any agreed upon payment terms AND fill out our Order Confirmation Form to get on a delivery schedule.`,

    "In Production": () =>
      `Your HaloRed is in Production. This means we are currently building your equipment -- Production can take up to 2 weeks. As soon as we have an ETA for your delivery, we will send that to you via email.`,

    "Sent Out": () =>
      `Your HaloRed has been sent out. This means that it has shipped or is scheduled to ship very soon. We are awaiting the ETA from the carrier, and will provide this to you as soon as it becomes available.`,

    "ETA": (data) => {
      const etaText = data.eta ? data.eta : "TBD";
      return `Your HaloRed is on its way! It is expected to reach your local ariport in ${etaText}\n\nPlease allow 2-5 days for this to clear customs, and the carrier will be reaching out to schedule a delivery date and`;
    },

    "Delivered": (data) => {
      const deliveredText = data.deliveredDate ? data.deliveredDate : "TBD";
      return `Your HaloRed was delivered on:\n${deliveredText}`;
    }
  };

  const soInput = document.getElementById("soInput");
  const checkBtn = document.getElementById("checkBtn");
  const errorBox = document.getElementById("errorBox");
  const resultBox = document.getElementById("resultBox");
  const statusPill = document.getElementById("statusPill");
  const resultMeta = document.getElementById("resultMeta");
  const resultMessage = document.getElementById("resultMessage");

  function showError(msg){
    errorBox.textContent = msg;
    errorBox.classList.add("show");
    resultBox.classList.remove("show");
  }

  function clearError(){
    errorBox.classList.remove("show");
    errorBox.textContent = "";
  }

  function normalizeSO(raw){
    return (raw || "").trim().toUpperCase().replace(/\s+/g, "");
  }

  async function checkStatus(){
    clearError();

    const so = normalizeSO(soInput.value);
    if(!so){
      showError("Please enter a Sales Order number (e.g., SO12345).");
      return;
    }

    if(SCRIPT_WEBAPP_URL === "PASTE_YOUR_WEB_APP_URL_HERE"){
      showError("Please paste your Apps Script Web App URL into the index.html file first.");
      return;
    }

    checkBtn.disabled = true;
    checkBtn.textContent = "Checking...";

    try{
      const res = await fetch(`${SCRIPT_WEBAPP_URL}?so=${encodeURIComponent(so)}`, { method: "GET" });
      const data = await res.json();

      if(!data.ok){
        showError(data.error || "Sales Order not found. Please double-check and try again.");
        return;
      }

      statusPill.textContent = data.status || "Unknown";
      resultMeta.textContent = `SO: ${data.so} • ${data.name || "Customer"}`;

      const formatter = STATUS_MESSAGES[data.status];
      const msg = formatter ? formatter(data) : `Status: ${data.status}`;
      resultMessage.textContent = msg;

      resultBox.classList.add("show");
    } catch(err){
      console.error(err);
      showError("Unable to retrieve status right now. Please try again in a moment.");
    } finally{
      checkBtn.disabled = false;
      checkBtn.textContent = "Check Status";
    }
  }

  checkBtn.addEventListener("click", checkStatus);
  soInput.addEventListener("keydown", (e) => {
    if(e.key === "Enter") checkStatus();
  });
</script>
</body>
</html>